<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="favicon.png"/>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }
        canvas
        {
            position: absolute;
    
            top: 127px;
    left: 50%;
    margin-left: -150px;
        }
        
        #myCanvas
        {
            left: 50%;
    margin-left: -150px;
            
        }
      
        #canvas2
        {
            top: 53px;
            margin-left: -150px;
        }

        button
        {
            background-color: Transparent;
        border: none;
        object-fit: cover;
        }
        
        button:hover
        {
        cursor: pointer;
        opacity:0.5;     
        }
        .copybtn{
height: 15px;
width: auto;
        }
.copybtn:hover{
    cursor: pointer;
        opacity:0.5;     
}
#colorCode::before{
    content: "rgba( ";
}
#colorCode::after{
    content: " )";
}
#colorCodeHex::before{
    content: "hex( ";
}
#colorCodeHex::after{
    content: " )";
}
@media only screen and (max-width: 600px) {

#reset{
    display: none;
}
#snap{
    display: none;
}

#video{
    display: none;
}

label::after{
    content: " or take a picture";

}

#display{
    margin-top: 225px;
}

}



input[type="file"] {
    display: none;
    border-radius: 20%;
    border-style: solid;
    border-width: 3px;
}

label:hover{
    cursor: pointer;
        opacity:0.5;
}
label{
    width: 30%;
    align-items: center;
    margin: auto;
    display: flex;
    justify-content: center;
    border-style: solid;
    border-width: 3px;
    padding: 2px;
    
    
}

#colors{
    display: none;
}

    
  



 
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    
</head>
<body>
    


    <div class="controller" style="text-align: center; ">
        <button id="snap" ><img src="camera.png" style="height: 50px; width: 50px; margin-left: 10px; display: inline;"></button>
        <button id="reset"><img src="reset.png" style="height: 50px; width: 50px; margin-left: 10px; display: inline;"></button>
        <input type='file' id="fileUpload" style=""/>
        <label for="fileUpload">
            <img src="https://img.icons8.com/ios/50/000000/upload.png"  height="50px" width="50px"/>

            Choose Photo
        </label>
    </div>

   

<!-- Stream video via webcam -->
<div class="video-wrap">
    <video id="video" style="top:30px; height: 100%; width: auto; z-index:7;"  playsinline autoplay></video>
</div>

<!-- Video Snapshot -->
<canvas id="canvas2"  z-index="6" top="200px" ></canvas></div>




<script>



    'use strict';
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas2');
    const snap = document.getElementById('snap');
    const reset = document.getElementById('reset');
    const errorMsgElement = document.getElementById('spanErrorMsg');
    const constraints = {
        audio: false,
        video: true
    };
    async function init(){
        try{
            const stream = await navigator.mediaDevices.getUserMedia(constraints);
            handleSuccess(stream);
        }
        catch(e){
            errorMsgElement.innerHTML = `navigator.getUserMedia.error:${e.toString()}`;
        }
    }
    // Success
    function handleSuccess(stream){
        window.stream = stream;
        video.srcObject = stream;
    }
    //Initialise 
    init();
    //Draw Image
    let context = canvas.getContext('2d');
    snap.addEventListener("click", function(){
        document.getElementById("video").style.display = 'none';
        canvas.style.display="block";
        document.getElementById("colors").style.display = "block";
        context.drawImage(video, 0, 0, 450, 150);
        const myCanvas = document.querySelector("#canvas2");
        
    });


    reset.addEventListener("click", function(){
        
        document.getElementById("video").style.display = 'block';
        canvas.style.display="none";
        document.getElementById("colors").style.display = "block";
        
    });

    const EL = (sel) => document.querySelector(sel);
const ctx = EL("#canvas2").getContext("2d");

function readImage() {
  if (!this.files || !this.files[0]) return;
  
  const FR = new FileReader();
  FR.addEventListener("load", (evt) => {
    const img = new Image();
    img.addEventListener("load", () => {
      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
      ctx.drawImage(img, 0, 0, 450, 150);
    });
    document.getElementById("video").style.display = 'none';
    canvas.style.display="block";
    document.getElementById("colors").style.display = "block";;
    img.src = evt.target.result;
  });
  FR.readAsDataURL(this.files[0]);
}

EL("#fileUpload").addEventListener("change", readImage);

    jQuery(document).ready(function(){
        var canvas = $("#myCanvas").get(0);
        //var context = canvas.getContext("2d");
        var image = document.getElementById("canvas2");
        
        image.id = "pic";
        

        jQuery(canvas).click(function(event){
            var canvasGap = $(canvas).offset();
            var actualX = Math.floor(event.pageX - canvasGap.left);
            var actualY = Math.floor(event.pageY - canvasGap.top);

            var pixelData = context.getImageData(actualX, actualY, 1, 1);
            var data = pixelData.data;
            var pixelColor = "rgba(" + data[0] + "," + data[1] + "," + data[2] + "," + data[3] + ")";

            $("#display").css("backgroundColor", pixelColor);
            $("#colorCode").text( data[0] + "," + data[1] + "," + data[2] + "," + data[3]);

            

            var r = data[0];
            var g = data[1];
            var b = data[2];
      
                            r = r.toString(16);
                g = g.toString(16);
                b = b.toString(16);
           

                if (r.length == 1)
                    r = "0" + r;
                if (g.length == 1)
                    g = "0" + g;
                if (b.length == 1)
                    b = "0" + b;
             

                
            $("#colorCodeHex").text("#" + r + g + b);
           
        });

    


    });


    function copyToClipboard(element) {
  var $temp = $("<input>");
  $("body").append($temp);
  $temp.val($(element).text()).select();
  document.execCommand("copy");
  $temp.remove();
}
   

</script>





<canvas id="myCanvas">
    your browser suck!!!
    
</canvas>
<div id="colors">
<div id="display" style="width:100%;height:100px; margin-top:159px; z-index: 7;"></div>
<p id="colorCode" style="z-index: 7;text-align: center; "></p> <img onclick="copyToClipboard('#colorCode')" id="copy1" class="copybtn" src="https://img.icons8.com/ios/50/000000/copy.png" text-align: center; />
<p id="colorCodeHex" style="z-index: 7; text-align: center; "></p> <img id="copy2" onclick="copyToClipboard('#colorCodeHex')" class="copybtn" src="https://img.icons8.com/ios/50/000000/copy.png" text-align: center; />
<img id="pic"></div>
</body>
</html>